# Plano de Teste para Model `TipoDemanda` (Sprint 5)

| Funcionalidade                          | Comportamento Esperado                                                                                   | Verificações                                                                               | Critérios de Aceite                                                                   |
| --------------------------------------- | -------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------- |
| Criação válida de tipo demanda          | Deve criar um tipo de demanda com todos os campos válidos e opcionais preenchidos corretamente           | Criar tipo demanda com título, descrição, link\_imagem, ícone, subdescrição e tipo válidos | O tipo demanda é salvo e retornado com \_id definido                                  |
| Validação de título obrigatório         | Deve retornar erro ao tentar criar um tipo demanda sem o campo título                                    | Criar tipo demanda sem título                                                              | Deve lançar erro de validação com mensagem "O título da demanda é obrigatório!"       |
| Validação de descrição obrigatória      | Deve retornar erro ao tentar criar um tipo demanda sem a descrição                                       | Criar tipo demanda sem descrição                                                           | Deve lançar erro de validação com mensagem "A descrição da demanda é obrigatória!"    |
| Validação de link\_imagem inválido      | Deve retornar erro ao criar tipo demanda com link\_imagem inválido (não URL válida ou formato incorreto) | Criar tipo demanda com link\_imagem inválido                                               | Deve lançar erro de validação com mensagem específica do erro                         |
| Aceitar link\_imagem vazio ou ausente   | Deve permitir salvar tipo demanda sem link\_imagem ou com link\_imagem vazio                             | Criar tipo demanda com link\_imagem vazia ou omitida                                       | O campo link\_imagem deve ser salvo como string vazia ""                              |
| Validação de ícone inválido             | Deve retornar erro ao criar tipo demanda com ícone inválido (não URL válida ou formato incorreto)        | Criar tipo demanda com ícone inválido                                                      | Deve lançar erro de validação com mensagem específica do erro                         |
| Aceitar ícone vazio ou ausente          | Deve permitir salvar tipo demanda sem ícone ou com ícone vazio                                           | Criar tipo demanda com ícone vazio ou omitido                                              | O campo ícone deve ser salvo como string vazia ""                                     |
| Validação de subdescrição obrigatória   | Deve retornar erro ao tentar criar tipo demanda sem subdescrição                                         | Criar tipo demanda sem subdescrição                                                        | Deve lançar erro de validação com mensagem "A subdescrição da demanda é obrigatória!" |
| Validação de tipo obrigatório           | Deve retornar erro ao tentar criar tipo demanda sem o campo tipo                                         | Criar tipo demanda sem tipo                                                                | Deve lançar erro de validação com mensagem "O tipo da demanda é obrigatório!"         |
| Listagem de tipos de demanda            | Deve listar todos os tipos de demanda cadastrados                                                        | Inserir múltiplos tipos demanda e fazer consulta                                           | A resposta contém todos os tipos cadastrados                                          |
| Atualização de tipo demanda existente   | Deve atualizar os dados de um tipo demanda existente pelo ID                                             | Atualizar o título ou outro campo de tipo demanda existente                                | O registro atualizado reflete as alterações                                           |
| Atualização de tipo demanda inexistente | Deve retornar null ao tentar atualizar tipo demanda com ID inexistente                                   | Atualizar tipo demanda com ID inválido ou inexistente                                      | Deve retornar null                                                                    |
| Remoção de tipo demanda existente       | Deve remover um tipo demanda existente pelo ID                                                           | Deletar um tipo demanda cadastrado pelo ID                                                 | O registro é removido e não pode ser mais encontrado                                  |
| Remoção de tipo demanda inexistente     | Deve retornar null ao tentar deletar tipo demanda com ID inexistente                                     | Deletar tipo demanda com ID inexistente                                                    | Deve retornar null                                                                    |
| Erro ao deletar com ID malformado       | Deve lançar erro ao tentar deletar tipo demanda com ID malformado (ex: string curta ou formato inválido) | Deletar tipo demanda com ID malformado                                                     | Deve lançar erro                                                                      |


# Plano de Teste para `TipoDemandaController` (Sprint 5)

| Funcionalidade        | Comportamento Esperado                                                   | Cenários/Testes                                                                                                                             | Critérios de Aceite                                           |
| --------------------- | ------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------- |
| Listar TipoDemandas   | Deve listar os tipos de demanda conforme filtros opcionais               | - Listar com parâmetros válidos<br>- Listar sem parâmetros<br>- Validar ID inválido<br>- Validar queries inválidas (titulo, tipo)           | Resposta 200 com dados esperados ou erro de validação lançado |
| Criar TipoDemanda     | Deve criar nova TipoDemanda com dados válidos                            | - Criar com dados válidos<br>- Lidar com erro no `toObject`<br>- Lidar com erro inesperado no service                                       | Resposta 201 com o recurso criado ou lançamento de erro       |
| Atualizar TipoDemanda | Deve atualizar TipoDemanda existente por ID                              | - Atualizar com dados válidos<br>- Lidar com erro inesperado no service                                                                     | Resposta 200 com dados atualizados ou lançamento de erro      |
| Deletar TipoDemanda   | Deve deletar TipoDemanda existente por ID                                | - Deletar com ID válido<br>- ID não fornecido (CustomError)<br>- ID inválido (erro validação Zod)<br>- Lidar com erro inesperado no service | Resposta 200 com confirmação ou lançamento de erro            |
| Tratamento de erros   | Deve lançar erros adequados nos casos de falhas de validação ou internas | - Lançar erro de validação Zod<br>- Lançar `CustomError` para casos específicos                                                             | Erros esperados com status e mensagens adequadas              |


# Plano de Teste para `TipoDemandaService` (Sprint 5)

| Funcionalidade                                       | Comportamento Esperado                                                  | Verificações                                                                                                           | Critérios de Aceite                                                                 |
| ---------------------------------------------------- | ----------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------- |
| Listar tipos de demanda                              | Deve retornar lista com todos os tipos de demanda                       | Chamada ao método listar do repository<br>Retorna array com os tipos                                                   | Retorna array esperado<br>Repository listar chamado                                 |
| Criar tipo de demanda com título único e tipo válido | Deve criar novo tipo de demanda se título não existir e tipo for válido | Busca por título inexistente<br>Chama criar do repository com dados válidos<br>Retorna dados criados                   | Tipo criado e retornado<br>BuscarPorTitulo e Criar chamados com parâmetros corretos |
| Criar tipo de demanda com título duplicado           | Deve lançar erro ao tentar criar com título já existente                | BuscarPorTitulo retorna objeto existente<br>Criação é impedida<br>Erro CustomError lançado                             | Erro lançado com mensagem específica (CustomError)                                  |
| Criar tipo de demanda com tipo inválido              | Deve lançar erro se o tipo informado não está na lista válida           | BuscarPorTitulo retorna null<br>Tipo inválido passado<br>Erro CustomError lançado                                      | Erro lançado pelo tipo inválido                                                     |
| Atualizar tipo de demanda existente                  | Deve atualizar tipo existente pelo ID com dados válidos                 | BuscarPorID retorna registro<br>BuscarPorTitulo retorna null ou diferente do próprio ID<br>Atualizar chamado com dados | Retorno com dados atualizados<br>Repository métodos chamados corretamente           |
| Atualizar tipo de demanda inexistente                | Deve lançar erro se tentar atualizar tipo não encontrado                | BuscarPorID retorna null<br>Erro CustomError lançado                                                                   | Erro lançado (CustomError)                                                          |
| Deletar tipo de demanda existente                    | Deve deletar registro existente pelo ID                                 | BuscarPorID retorna registro<br>Chama deletar do repository<br>Retorna resultado da exclusão                           | Registro removido<br>Repository chamado com ID correto                              |
| Deletar tipo de demanda inexistente                  | Deve lançar erro ao tentar deletar tipo não existente                   | BuscarPorID retorna null<br>Erro CustomError lançado                                                                   | Erro lançado (CustomError)                                                          |


# Plano de Teste para `TipoDemandaRepository` (Sprint 5)

| Funcionalidade                      | Comportamento Esperado                                    | Verificações                                                                                | Critérios de Aceite                                                     |
| ----------------------------------- | --------------------------------------------------------- | ------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------- |
| Buscar tipo de demanda por ID       | Deve retornar o tipo de demanda correspondente ao ID      | `findOne` chamado com filtro `{ _id: ObjectId }`<br>Retorna objeto esperado                 | Objeto retornado conforme mock<br>Lança `CustomError` se não encontrado |
| Buscar tipo de demanda por título   | Deve retornar tipo de demanda pelo título                 | `findOne` chamado com filtro `{ titulo: string }` ou `{ titulo: string, _id: { $ne: id } }` | Objeto retornado conforme mock                                          |
| Buscar tipo de demanda por tipo     | Deve retornar tipo de demanda pelo tipo                   | `findOne` chamado com filtro `{ tipo: string }` ou `{ tipo: string, _id: { $ne: id } }`     | Objeto retornado conforme mock                                          |
| Listar tipos de demanda             | Se `req.params.id` existir, deve buscar por ID            | `findById` chamado com ID<br>Retorna objeto esperado ou lança `CustomError`                 | Retorna objeto esperado ou lança erro caso não encontrado               |
|                                     | Caso contrário, deve listar com paginação e filtros       | `paginate` chamado com filtros e paginação<br>Retorna resultado paginado                    | Resultado paginado retornado corretamente                               |
|                                     | Deve lançar erro se não encontrar nenhum tipo na listagem | `paginate` retorna docs vazio<br>Lança `CustomError`                                        | Lança erro quando docs vazios                                           |
| Criar novo tipo de demanda          | Deve criar novo tipo de demanda e salvar                  | Instância do model criada com dados<br>Método `save` chamado<br>Retorna objeto criado       | Model instanciado e salvo<br>Retorna dados criados                      |
| Atualizar tipo de demanda existente | Deve atualizar tipo de demanda pelo ID                    | `findByIdAndUpdate` chamado com ID, dados e `{ new: true }`<br>Retorna objeto atualizado    | Objeto atualizado retornado<br>Lança erro se não encontrado             |
| Deletar tipo de demanda             | Deve deletar tipo de demanda pelo ID                      | `findByIdAndDelete` chamado com ID<br>Retorna objeto deletado                               | Objeto deletado retornado                                               |


# Plano de teste para `TipoDemanda Endpoint` (Sprint 7)

| Funcionalidade                     | Comportamento Esperado                                        | Cenários/Testes                                                                                                  | Critérios de Aceite                     |
| ---------------------------------- | ------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------- | --------------------------------------- |
| Listar tipos de demanda            | Deve retornar uma lista de tipos de demanda cadastrados       | - Requisição GET `/tipoDemanda` com token válido<br>- Resposta 200 com mensagem "Requisição bem-sucedida"        | Status 200 e lista no corpo da resposta |
| Obter tipoDemanda por ID           | Deve retornar tipoDemanda correspondente ao ID                | - Requisição GET `/tipoDemanda/:id` com ID válido e token<br>- Resposta 200 com objeto correspondente            | Status 200 e objeto correto no corpo    |
| Obter tipoDemanda por ID inválido  | Deve retornar erro quando ID não existe                       | - Requisição GET `/tipoDemanda/:idInvalido` com token<br>- Resposta 404 com mensagem "Recurso não encontrado"    | Status 404 com mensagem de erro         |
| Criar novo tipoDemanda             | Deve criar um novo tipoDemanda com dados válidos              | - Requisição POST `/tipoDemanda` com corpo válido e token<br>- Resposta 201 com dados criados                    | Status 201 e dados criados no corpo     |
| Criar tipoDemanda com título vazio | Deve retornar erro de validação                               | - Requisição POST `/tipoDemanda` com título vazio e token<br>- Resposta 400 com mensagem de erro de validação    | Status 400 e mensagem de erro           |
| Atualizar tipoDemanda              | Deve atualizar parcialmente dados de um tipoDemanda existente | - Requisição PATCH `/tipoDemanda/:id` com dados válidos e token<br>- Resposta 200 com dados atualizados          | Status 200 e dados atualizados no corpo |
| Atualizar tipoDemanda inexistente  | Deve retornar erro ao tentar atualizar tipo inexistente       | - PATCH `/tipoDemanda/:idInvalido` com token<br>- Resposta 404 com mensagem "Recurso não encontrado"             | Status 404 e mensagem de erro           |
| Deletar tipoDemanda                | Deve deletar um tipoDemanda existente com sucesso             | - POST para criar, DELETE `/tipoDemanda/:idCriado` com token<br>- Resposta 200 com confirmação e dados deletados | Status 200 e confirmação da exclusão    |
| Deletar tipoDemanda inválido       | Deve retornar erro ao tentar deletar com ID inválido          | - DELETE `/tipoDemanda/:idInvalido` com token<br>- Resposta 404 com mensagem "Recurso não encontrado"            | Status 404 e mensagem de erro           |
